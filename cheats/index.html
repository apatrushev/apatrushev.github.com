<!doctype html>
<meta charset="utf-8">
<link rel="stylesheet" href="../static/style.css">
<title>Cheats â€” patrushev.me</title>
<script src="../static/clipboard.js"></script>

<body>
    <header style="position: relative;">
        <a
        href="https://github.com/apatrushev/apatrushev.github.io"
        class="github-corner"
        >
            <object
                    type="image/svg+xml"
                    data="/static/octocat.svg"
            ></object>
        </a>
        <a href="/">
            <h1>Anton Patrushev</h1>
        </a>
    </header>
    <div class="page">
        
  <h2>Create venv</h2>
<p>Use <a href="https://github.com/apatrushev/get-venv-builder">apatrushev/get-venv-builder</a> to create fresh empty
virtualenv. This method independent from host environment as much as possible and works on both Python2
and Python3.</p>
<pre><code>curl -L bit.ly/329DB9d | python -
</code></pre>
<p>Yeah, it is curl python so all your base are belong to us! In fact it is shortened version of:</p>
<pre><code>curl https://raw.githubusercontent.com/apatrushev/get-venv-builder/master/clean.py | python -
</code></pre>
<h2>Python getch</h2>
<p>Pythons input/raw_input are not very suitable when you need to ask single letter question because user
will have to press at least two keys. For that cases following snippet can be used. It is minimalistic
unix only version of getch for python:</p>
<pre><code class="lang-python">import sys
import termios
import tty

def getch():
    fd = sys.stdin.fileno()
    old_settings = termios.tcgetattr(fd)
    try:
        tty.setraw(sys.stdin.fileno())
        ch = sys.stdin.read(1)
    finally:
        termios.tcsetattr(fd, termios.TCSADRAIN, old_settings)
    return ch

getch()
</code></pre>
<h2>asyncio vs ipdb workaround</h2>
<p>ipdb do not work in asyncio applications (<a href="https://github.com/gotcha/ipdb/issues/184">issue details</a>).
Core problem is quite twisted and probably will not be fixed for a long time. Workaround below helps
to use ipdb with asyncio:</p>
<pre><code class="lang-python">def threaded(func):
    def wrapper(*args, **kwargs):
        result = []
        def target():
            result.append(func(*args, **kwargs))
        thread = threading.Thread(target=target)
        thread.start()
        thread.join()
        return result[0]
    return wrapper
from IPython.terminal.debugger import TerminalPdb
TerminalPdb.cmdloop = threaded(TerminalPdb.cmdloop)
</code></pre>
<p><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css"></p>
<p><script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js"></script></p>
<p><script>hljs.initHighlightingOnLoad();</script></p>
<p><script>
Array.from(document.getElementsByTagName('pre')).map(element => {
    element.addEventListener('click', event => {
        copyTextToClipboard(event.target.innerText);
    });
});
</script></p>
<style>
pre {
    cursor: pointer;
    border: 1px solid black;
    padding: 20px;
}
code {
    background: white !important;
}
h2 {
    border-bottom: 2px solid #ccc !important;
}
</style>

    </div>
    <footer>
        &copy; Copyright 2019-2021 by <a href="mailto:apatrushev@gmail.com">apatrushev@gmail.com</a>.
        <div><a href="/cheats">Cheats</a></div>
    </footer>
</body>
